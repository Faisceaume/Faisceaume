<main>
  <header>
    <h1 *ngIf="previousFormData.project">{{ operationType }} un bug au projet {{ previousFormData.project.title }}</h1>
    
    <app-auth-user [rolesGranted]="rolesGranted" (isGrantedEvent)="isAuthUserGranted($event)"></app-auth-user>
  </header>

  <form class="mat-elevation-z8"
    *ngIf="isGranted"
    #form="ngForm" autocomplete="off"
    (ngSubmit)="onSubmit(form)">

    <input type="hidden"
      *ngIf="previousFormData.bugid"
      #bugid="ngModel" name="bugid"
      [(ngModel)]="previousFormData.bugid">
    <input type="hidden"
      *ngIf="previousFormData.projectid"
      #projectid="ngModel" name="projectid"
      [(ngModel)]="previousFormData.projectid">
    <input type="hidden"
      *ngIf="previousFormData.memberid"
      #memberid="ngModel" name="memberid"
      [(ngModel)]="previousFormData.memberid">
      
    <input type="hidden"
      *ngIf="previousFormData.project"
      #project="ngModel" name="project"
      [(ngModel)]="previousFormData.project">

    <mat-form-field>
      <mat-label>Titre</mat-label>
      <input matInput type="text"
        placeholder="Titre"
        #title="ngModel" name="title"
        [(ngModel)]="previousFormData.title" 
        required>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Description</mat-label>
      <textarea matInput type="text" rows="5"
        #descriptionclient="ngModel" name="descriptionclient"
        placeholder="Description"
        [(ngModel)]="previousFormData.descriptionclient" 
        required></textarea>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Composant concerné</mat-label>
      <input matInput type="text"
        placeholder="Composant concerné"
        #component="ngModel" name="component"
        [(ngModel)]="previousFormData.component">
    </mat-form-field>

    <app-upload-image [title]="titleImgUpload"></app-upload-image>

    <div class="btn-group-container">
      <button mat-raised-button color="basic" type="button"
        (click)="onRedirectBack()">
        Annuler
      </button>
      <button mat-raised-button color="primary" type="submit"
        [disabled]="form.invalid">
        {{ operationType }}
      </button>
    </div>

  </form>
</main>